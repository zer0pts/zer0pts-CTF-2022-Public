#include <stdio.h>
#include <windows.h>

BYTE ans[] =
  "\x33\x12\x95\x67\xe0\xbd\x78\x7e\xfb\x15\xa2\x63\x07\xe5\x31\x1e\x06\xba\x66\xe3\xb8\xdb\xc2\x20\x6a\xd5\x9f\x99\x78\x0a\x4d\x78"
  "\xdd\x19\x16\x96\xe1\x5e\x2e\xe2\x93\x41\x0d\x02\x45\x4c\x5f\x94\x61\xa2\x24\x9d\xee\x6d\x57\xc7\x5f\x26\x4e\xae\xb8\x3a\x37\x82"
  "\xe7\x5b\x11\xda\x69\x3d\x7b\xb5\x27\x39\x85\xdc\xf9\xf0\x27\x29\x45\x5d\xa7\xe7\xc8\x0e\x54\xa0\x61\x5e\x00\xec\x2a\xe7\x6d\x8e"
  "\x04\x24\x9e\x0c\x25\x8e\x1a\x4e\x43\xcf\xda\xe2\x91\xa8\x35\xcd\x15\x73\x5f\x65\x0b\xbb\xba\x04\x65\xad\xa1\xcd\x98\x46\x62\x2a"
  "\xe4\x22\x3e\xd2\x0d\x7e\xa5\x74\x0a\x32\x6e\x2b\x26\x8c\xa6\xdb\x91\xd0\x41\xcf\x51\x94\xf5\x77\xe3\x93\xa8\xba\x3b\x85\xd8\xe9"
  "\x8b\x53\x63\x9f\x15\x2c\x8f\xc6\xef\x30\x80\x2f\xde\x46\x2b\xa0\xbe\x9c\xf0\x85\xf7\x58\x0d\xc6\x9e\xfd\x72\xe0\x02\xab\xbb\x35"
  "\x01\x17\x83\x4b\xf6\x0d\xcf\x97\x72\x29\xbf\x1e\x98\x2c\xf9\xbc\x63\xb6\x0e\xf4\x20\x52\xf7\xce\x7e\x80\x0c\xe1\x21\x6a\x9a\xf6"
  "\x74\x1d\x14\xdf\x73\x0e\x53\xa5\xa0\x19\xa7\x10\x11\x6f\x69\x6d\xb4\xec\x23\xa1\x32\xb7\x4c\xf6\xfb\xb3\xcf\x76\x17\xe6\x83\x13"
  "\xe3\x0e\x58\x0a\x4c\x29\x16\xbc\xff\x30\xca\x04\x7f\x2d\x6a\x49\x41\x68\xce\xaf\x8f\xb9\x17\x10\x37\xa7\x73\xa9\xf8\xe7\x26\x8e"
  "\x29\x47\x63\x75\x4a\x8e\xfd\x4c\x73\x9d\x9f\x67\x9b\xfc\xa3\xab\x51\x01\x06\xf4\x2d\xdb\x5d\xc0\x21\x6b\xa8\xbc\x98\xba\x31\x58"
  "\x46\xc9\xe2\x20\x99\xee\x4b\xfe\x54\xa9\x9a\x3c\xdb\xaf\x69\xf1\x7f\x7c\x6e\x25\x81\xb9\x2f\x7b\xab\x25\x12\x8f\xd2\x10\x0b\x7a"
  "\x68\xdb\xf7\x3d\x03\xd3\xa5\x10\x7e\xda\xd3\xb0\x56\x76\xee\xe2\x40\xe6\x8c\x28\x02\x96\xe5\x2b\x69\x86\x87\x3c\x54\xce\xf3\xcb"
  "\xc1\x81\x8d\x58\x0d\x8c\x8b\xc1\x11\x30\x2f\x4a\x5e\x69\x03\xef\x2d\x32\xb1\x1a\x56\x13\xef\xba\x50\x76\x93\xde\x80\x60\xfb\x8c"
  "\x44\xad\x63\xf6\x0a\xf0\xf6\xdb\x6f\xdd\xe6\xd5\x18\x6e\xf7\x81\x76\x36\x7d\xf2\x61\xfa\x06\xbe\x30\x79\xb6\xc8\x0c\x8a\xdb\xa4"
  "\x46\xc9\xe2\x20\x99\xee\x4b\xfe\x54\xa9\x9a\x3c\xdb\xaf\x69\xf1\x7f\x7c\x6e\x25\x81\xb9\x2f\x7b\xab\x25\x12\x8f\xd2\x10\x0b\x7a"
  "\x5e\x07\xd6\xfd\xc6\x02\xb0\xf9\xb9\x9f\x6e\xa2\x4c\x39\xe6\x58\x35\x99\x2f\xaa\xc4\x00\x26\x4c\x52\x44\x9b\xc4\x09\xcf\x4e\xfa"
  "\xe4\xdc\xd6\xd3\x13\xaf\x71\x55\x95\x96\xd3\x00\x9c\x12\xd0\x25\x30\x18\x42\xd8\xc7\xf8\x88\xc2\x85\x03\x33\xe9\x1a\x9b\xda\x68"
  "\xff\xfd\xff\x4b\x07\xa9\xd9\x73\xfd\x1c\x3a\x6b\xe4\x43\x85\x1b\xc1\x3e\x82\xc4\xaf\x94\xc8\x83\x25\x24\x46\x94\xe3\x52\xaa\x31"
  "\x3f\xff\xd0\x18\xd2\x22\x30\x20\xbe\x85\x67\x0d\x93\xf5\x65\xb6\x3d\xf5\x4a\x9c\xe3\xed\x2c\xdf\x63\x47\xa6\x1d\xf0\x16\x93\x8c"
  "\xb2\x94\x18\x52\x28\x25\x62\xcc\x3d\x81\x3e\x8b\xf1\x70\x5d\x04\x80\xa7\xa0\x08\xff\xa2\x47\x55\x01\xd7\xc5\x16\x11\x65\xa7\xfb"
  "\x63\x5c\xa7\x3d\x00\xd4\xf2\x8b\x5f\x57\x3b\x16\xee\xa5\x6e\x9e\x45\x79\xd7\x7e\x56\x1c\x32\xaa\x68\x18\x9d\x97\x69\xfa\x17\x53"
  "\xa4\xd0\xef\x23\x16\x1b\x5b\x7c\x6a\x8d\x5b\x28\x75\x43\xfd\x74\xe1\x6b\x3b\xf3\x13\xd7\x1a\xa1\x87\xc2\x4c\xdd\x72\x8a\x7b\x1e"
  "\xe0\xb9\xa8\x79\x9f\x32\x45\x3a\x47\x8c\x91\x22\xf8\xb8\x3c\xee\x68\xe1\x6d\xb1\x8f\x49\x3a\xc8\x1b\xc1\xd4\x74\x59\x4b\x5d\xf4"
  "\x56\x49\x99\xcb\xbf\xea\x80\x17\x0b\xa0\x68\xdc\xf9\x61\xd9\x91\x46\x25\xf3\xbe\x95\x1b\x2c\x1f\xe1\x63\xba\xe0\xf8\x15\x6c\x24"
  "\x4a\x44\xdc\x15\x36\x42\x04\xa8\x0f\xe8\x0e\x90\x39\x45\x5c\xc1\x60\x82\x81\x82\x0f\xe2\xb2\x4f\x1e\x52\x33\xad\xe6\xaf\x1d\xd5"
  "\xe9\x17\x87\x06\x8a\x3c\x60\xe9\x71\x2a\x7a\xbe\xb6\xa6\x7f\x51\x8a\x40\x72\x3c\x1b\x89\xc1\x1d\x60\x70\xfe\x5f\x93\x89\xeb\xf9"
  "\x7e\xb7\x02\x57\x59\x3d\xa0\x6f\x68\x2a\x3d\xdd\xa5\x4a\x9d\x26\x0d\x4f\xc5\x14\xf6\x45\x23\x7f\x5c\xa7\x4b\x08\xf8\xda\x61\xa6"
  "\x96\xa2\x96\xd2\x24\xf2\x85\xc6\x7b\xee\x93\xc3\x0f\x8a\x30\x91\x57\xf0\xda\xa3\x5d\xc5\xb8\x7e\x41\x0b\x78\x63\x0a\x09\xcf\xc7"
  "\x96\xa2\x96\xd2\x24\xf2\x85\xc6\x7b\xee\x93\xc3\x0f\x8a\x30\x91\x57\xf0\xda\xa3\x5d\xc5\xb8\x7e\x41\x0b\x78\x63\x0a\x09\xcf\xc7"
  "\x96\xa2\x96\xd2\x24\xf2\x85\xc6\x7b\xee\x93\xc3\x0f\x8a\x30\x91\x57\xf0\xda\xa3\x5d\xc5\xb8\x7e\x41\x0b\x78\x63\x0a\x09\xcf\xc7"
  "\x96\xa2\x96\xd2\x24\xf2\x85\xc6\x7b\xee\x93\xc3\x0f\x8a\x30\x91\x57\xf0\xda\xa3\x5d\xc5\xb8\x7e\x41\x0b\x78\x63\x0a\x09\xcf\xc7"
  "\x96\xa2\x96\xd2\x24\xf2\x85\xc6\x7b\xee\x93\xc3\x0f\x8a\x30\x91\x57\xf0\xda\xa3\x5d\xc5\xb8\x7e\x41\x0b\x78\x63\x0a\x09\xcf\xc7";

BOOL CheckFlag(CHAR *flag) {
  BOOL r = TRUE;
  HCRYPTPROV hProv;
  HCRYPTHASH hHash;
  BYTE pbHash[32];
  DWORD dwDataLen = 32;

  CryptAcquireContext(&hProv, NULL, NULL, PROV_RSA_AES, CRYPT_VERIFYCONTEXT);
  for (int i = 0; i < dwDataLen; i++) {
    CryptCreateHash(hProv, CALG_SHA_256, 0, 0, &hHash);
    CryptHashData(hHash, &flag[i*2], 2, 0);
    CryptGetHashParam(hHash, HP_HASHVAL, pbHash, &dwDataLen, 0);
    for (int j = 0; j < 32; j++) {
      r &= pbHash[j] == ans[i*32+j];
    }
  }

  return r;
}

DWORD main() {
  DWORD len;
  CHAR flag[0x40] = {0};
  HANDLE hin;
  HANDLE hout;

  hin  = GetStdHandle(STD_INPUT_HANDLE);
  hout = GetStdHandle(STD_OUTPUT_HANDLE);
  if (hin == INVALID_HANDLE_VALUE || hout == INVALID_HANDLE_VALUE)
    ExitProcess(1);

  WriteConsole(hout, "FLAG: ", 6, &len, NULL);
  ReadConsole(hin, flag, 0x3f, &len, NULL);
  if (CheckFlag(flag))
    WriteConsole(hout, "Correct!\n", 9, &len, NULL);
  else
    WriteConsole(hout, "Wrong...\n", 9, &len, NULL);

  CloseHandle(hin);
  CloseHandle(hout);
  return 0;
}
